<!--{include header_gerenciar}-->
<script type="text/javascript">$(function(){Gerenciar.produto_pedido.init();});</script>
<div class="row">
	<div class="page-title">
		<div class="col-lg-2 col-md-3 col-sm-3 col-xs-6">
			<h3>Vendas</h3>
		</div>
		<form method="get" action="/gerenciar/produto_pedido/" id="search-form">
			<div class="col-lg-2 col-md-3 col-sm-3 col-xs-6 form-group">
				<label for="modulo">Módulo:</label>
				<select class="form-control" id="modulo" name="modulo">
					${Utility::Option($_modulo_names, $_GET['modulo'], 'Todos')}
				</select>
			</div>
			<div class="col-lg-2 col-md-3 col-sm-3 col-xs-6 form-group">
				<label for="estado">Estado:</label>
				<select class="form-control" id="estado" name="estado">
					${Utility::Option($_estado_names, $_GET['estado'], 'Todos')}
				</select>
			</div>
			<div class="col-lg-2 col-md-3 col-sm-3 col-xs-6 form-group">
				<label for="tipo">Tipo:</label>
				<select class="form-control" id="tipo" name="tipo">
					${Utility::Option($_tipo_names, $_GET['tipo'], 'Todos')}
				</select>
			</div>
			<div class="form-group col-lg-2 col-md-4 col-sm-4 col-xs-6">
				<label for="inicio">Data inicial:</label>
				<input type="text" id="inicio" name="datahora_inicio" class="datetime-picker form-control" value="{$_GET['datahora_inicio']}">
			</div>
			<div class="form-group col-lg-2 col-md-4 col-sm-4 col-xs-6">
				<label for="fim">Data final:</label>
				<input type="text" id="fim" name="datahora_fim" class="datetime-picker form-control" value="{$_GET['datahora_fim']}">
			</div>
<!--${$_funcao = $_funcionario->findFuncaoID()}-->
<!--${$_cliente_func = $_funcionario->findClienteID()}-->
			<input type="hidden" id="funcionarioid" name="funcionario_id" data-content="{$_cliente_func->getNomeCompleto()}" value="{$_funcionario->getID()}">
			<div class="form-group col-lg-3 col-md-4 col-sm-4 col-xs-6 col-lg-offset-2">
				<label for="funcionario">Atendente: <span class="identifier">{$_funcao->getDescricao()}<span></label>
				<input type="text" id="funcionario" class="form-control" value="{$_cliente_func->getNomeCompleto()}">
			</div>
<!--${$_categoria = $_produto->findCategoriaID()}-->
			<input type="hidden" id="produtoid" name="produto_id" data-descricao="{$_produto->getDescricao()}" value="{$_produto->getID()}">
			<div class="form-group col-lg-3 col-md-6 col-sm-6 col-xs-6">
				<label for="produto">Produto: <span class="identifier">{$_categoria->getDescricao()}<span></label>
				<input type="text" id="produto" class="form-control" value="{$_produto->getDescricao()}">
			</div>
			<div class=" form-group col-lg-4 col-md-6 col-sm-6 col-xs-12">
				<label>Busca:</label>
				<div class="input-group">
					<input type="text" class="form-control" id="query" name="query" placeholder="Pedido ou Observação..." value="${\MZ\Util\Filter::input($_GET, 'query')}">
					<span class="input-group-btn">
						<button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
					</span>
				</div>
			</div>
			<input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;" tabindex="-1" />
		</form>
	</div>
	<div class="clearfix"></div>
	<div class="">
		<div class="col-md-12 col-sm-12 col-xs-12">
			<div class="x_panel">
				<div class="x_title">
					<h2>Produtos, serviços e descontos</h2>
					<div class="clearfix"></div>
				</div>
				<div class="x_content x_scroll">
					<table class="table">
						<thead>
							<tr>
								<th>Pedido</th>
								<th>Destino</th>
								<th>Produto/Serviço</th>
								<th class="text-right">Preço</th>
								<th class="text-center">Quantidade</th>
								<th class="text-right">Comissão</th>
								<th class="text-right">Total</th>
								<th class="text-right">Custo</th>
								<th class="text-right">Lucro</th>
								<th class="text-center">Atendente</th>
								<th class="text-center">Data e hora</th>
							</tr>
						</thead>
						<tbody>
<!--{loop $itens_do_pedido $produto_pedido}-->
							<tr ${$produto_pedido->isCancelado()?'class="danger"':''}>
<!--${$_pedido = $produto_pedido->findPedidoID()}-->
								<td><div title="{$_modulo_names[$_pedido->getTipo()]}" class="cell-icon pedido-icons" style="background-position: -{$_pedido_icon[$_pedido->getTipo()]}px 0px;"></div><a href="/gerenciar/pedido/?query={$produto_pedido->getPedidoID()}" title="Visualizar pedido '{$produto_pedido->getPedidoID()}'">{$produto_pedido->getPedidoID()}</a></td>
<!--${$_comanda = $_pedido->findComandaID()}-->
<!--${$_mesa = $_pedido->findMesaID()}-->
								<td>${$_pedido->getTipo() == Pedido::TIPO_ENTREGA && is_null($_pedido->getLocalizacaoID())?'Viagem':($_pedido->getTipo() == PedidoTipo::MESA?$_mesa->getNome():($_pedido->getTipo() == PedidoTipo::COMANDA?$_comanda->getNome():$_modulo_names[$_pedido->getTipo()]))}</td>
<!--${$_produto = $produto_pedido->findProdutoID()}-->
<!--${$_servico = $produto_pedido->findServicoID()}-->
								<td><strong>
<!--{if is_null($produto_pedido->getServicoID())}-->
									<a href="/gerenciar/produto/editar?id={$_produto->getID()}" title="Editar produto '{$_produto->getDescricao()}'">{$_produto->getDescricao()}</a>
<!--{else}-->
									<a href="/gerenciar/servico/editar?id={$_servico->getID()}" title="Editar serviço '{$_servico->getDescricao()}'">{$_servico->getDescricao()}</a>
<!--{/if}-->
									</strong><small>{$produto_pedido->getDetalhes()}</small>
								</td>
								<td class="text-right">${\MZ\Util\Mask::money($produto_pedido->getPreco(), true)}</td>
								<td class="text-center">{$produto_pedido->getQuantidade()}</td>
								<td class="text-right">${\MZ\Util\Mask::money($produto_pedido->getComissao(), true)}</td>
								<td class="text-right">${\MZ\Util\Mask::money($produto_pedido->getTotal(), true)}</td>
								<td class="text-right">${\MZ\Util\Mask::money($produto_pedido->getCusto(), true)}</td>
								<td class="text-right">${\MZ\Util\Mask::money($produto_pedido->getLucro(), true)}</td>
<!--${$_funcionario = $produto_pedido->findFuncionarioID()}-->
<!--${$_cliente = $_funcionario->findClienteID()}-->
								<td class="text-center"><a href="/gerenciar/funcionario/editar?id={$_funcionario->getID()}" title="Editar funcionário '{$_cliente->getNomeCompleto()}'">{$_cliente->getNomeCompleto()}</a></td>
								<td class="text-center">${is_null($produto_pedido->getDataHora())?'':date('d/m/Y H:i', strtotime($produto_pedido->getDataHora()))}</td>
							</tr>
<!--{/loop}-->
						</tbody>
					</table>
					{$pagestring}
				</div>
			</div>
		</div>
	</div>
</div>	
<!--{include footer_gerenciar}-->