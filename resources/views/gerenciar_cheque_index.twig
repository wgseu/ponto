{{ include('header_gerenciar.twig') }}
<script type="text/javascript">
  $(function () {
    Gerenciar.cheque.init();
  });
</script>
<div class="row">
  <div class="page-title">
    <div class="col-lg-4 col-md-6 col-sm-6 col-xs-6">
      <h3>Cheques</h3>
    </div>
    <form method="get" action="/gerenciar/cheque/" id="search-form">
      <div class="form-group col-lg-2 col-md-6 col-sm-6 col-xs-6">
        <label for="estado">Estado:</label>
        <select class="form-control" id="estado" name="estado">
          <option value="" {{ !array_key_exists($this->get('estado'), $estados) ? 'selected': '' }}>Todos</option>
          {% for $value, $text in $estados %}
            <option value="{{ $value }}" {{ $this->get('estado') == $value ? 'selected': '' }}>{{ $text }}</option>
          {% endfor %}
        </select>
      </div>
      <input type="hidden" id="bancoid_ref" name="bancoid" data-content="{{ $_banco->getRazaoSocial() }}" value="{{ $_banco->getID() }}">
      <div class="form-group col-lg-3 col-md-6 col-sm-6 col-xs-12">
        <label for="bancoid">Banco:
          <span class="identifier">{{ $_banco->getNumero() }}
          </span>
        </label>
        <input type="text" id="bancoid" class="form-control" value="{{ $_banco->getRazaoSocial() }}">
      </div>
      <input type="hidden" id="clienteid_ref" name="clienteid" data-content="{{ $_cliente->getNomeCompleto() }}" value="{{ $_cliente->getID() }}">
      <div class="form-group col-lg-3 col-md-6 col-sm-6 col-xs-12">
        <label for="clienteid">Cliente:
          <span class="identifier">{{ \MZ\Util\Mask::phone($_cliente->getTelefone()->getNumero()) }}
          </span>
        </label>
        <div class="input-group">
          <input type="text" id="clienteid" class="form-control" value="{{ $_cliente->getNomeCompleto() }}">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">
              <i class="fa fa-search"></i>
            </button>
          </span>
        </div>
      </div>
      <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;" tabindex="-1"/>
    </form>
  </div>
  <div class="clearfix"></div>
  <div class="">
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div class="x_panel">
        <div class="x_title">
          <h2>Cheques<small></small>
          </h2>
          <div class="clearfix"></div>
        </div>
        <div class="x_content x_scroll">
          <table class="table">
            <thead>
              <tr>
                <th>Cliente</th>
                <th>Banco</th>
                <th>Agência</th>
                <th>Conta</th>
                <th>Valor</th>
                <th>Número</th>
                <th>Vencimento</th>
                <th>Recolhido</th>
                <th width="10%" style="text-align: center;">Ações</th>
              </tr>
            </thead>
            <tbody>
              {% for $cheque in $cheques %}
                {% $_cheque = $cheque->findChequeID() %}
                <tr class="{{ $_cheque->isCancelado() ? 'active': ($cheque->isRecolhido() ? 'success': '') }}">
                  {% $_banco = $_cheque->findBancoID() %}
                  {% $_cliente = $_cheque->findClienteID() %}
                  <td>{{ $_cliente->getNomeCompleto() }}</td>
                  <td>
                    <a href="/gerenciar/banco/editar?id={{ $_banco->getID() }}" title="Editar banco '{{ $_banco->getRazaoSocial() }}'">{{ $_banco->getRazaoSocial() }}</a>
                  </td>
                  <td>{{ $_cheque->getAgencia() }}</td>
                  <td>{{ $_cheque->getConta() }}</td>
                  <td>{{ $this->currency($cheque->getValor()) }}</td>
                  <td>{{ $cheque->getNumero() }}</td>
                  <td>{{ $this->datetime($cheque->getVencimento()) }}</td>
                  <td>
                    <strong>{{ $cheque->getRecolhido() == 'Y'?'Sim':'Não' }}</strong>
                    <small>{{ $this->datetime($cheque->getRecolhimento()) }}</small>
                  </td>
                  <td class="text-center">
                    <ul class="nav panel_toolbox">
                      <li>
                        <a href="/gerenciar/cheque/recolher?id={{ $cheque->getID() }}" title="Recolher folha de cheque '{{ $cheque->getNumero() }}' do cliente {{ $_cliente->getNomeCompleto() }}" class="ajaxlink" ask="Deseja recolher a folha de cheque '{{ $cheque->getNumero() }}' do cliente {{ $_cliente->getNomeCompleto() }}?">
                          <i class="fa fa-university"></i>
                        </a>
                      </li>
                    </ul>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          {{ include('pagination.twig') }}
        </div>
      </div>
    </div>
  </div>
</div>
{{ include('footer_gerenciar.twig') }}